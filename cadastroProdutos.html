<html>
<head>
  <meta charset="UTF-8">
  <link rel="stylesheet" href="cadastroProdutos.css">
  <title>Churrastop</title>
</head>
<body>
  <div class="wrapper">
    <div class="form-wrapper">
      <div class="form">
        <h1>Cadastro de Produto</h1>
        <div class="nomeProduto">
          <label>Nome</label>
          <input type="text" id="nomeProduto" placeholder="Nome" required />
          <span class="error" id="error_nomeProduto"></span>
        </div>
        <div class="marca">
          <label>Marca</label>
          <input type="text" id="marca" placeholder="Marca" required />
          <span class="error" id="error_marca"></span>
        </div>
        <div class="preco">
          <label>Preço</label>
          <input type="text" id="preco" placeholder="Preço" required />
          <span class="error" id="error_preco"></span>
        </div>
        <div class="quantidade">
          <label>Quantidade</label>
          <input type="text" id="quantidade" placeholder="Quantidade" required />
          <span class="error" id="error_quantidade"></span>
        </div>
        <div class="botao">
          <button onclick="cadastrarProduto()">Concluir</button>
        </div>
      </div>
    </div>
  </div>
  <div id="id01" class="modal">
    <div class="modal-content animate">
      <div class="container">
       <div class="nome">
          <label>Nome</label>
          <input type="text" id="nome" placeholder="Nome" required />
          <span class="error" id="error_nome"></span>
        </div>
        <div class="senha">
          <label>Senha</label>
          <input type="password" id="senha" placeholder="Senha" required />
          <span class="error" id="error_senha"></span>
        </div>
        <div class="botao">
          <button>Confirmar</button>
          <button type="button" onclick="closeModal()">Cancelar</button>
        </div>
      </div>
    </div>
  </div>
  <script>

    function request(url, data){
      var http = new XMLHttpRequest();
      var url = "url";
      var params = JSON.stringify(data);
      http.open("POST", url, true);
      http.setRequestHeader("Content-type", "application/json; charset=utf-8");
      http.setRequestHeader("Content-length", params.length);
      http.setRequestHeader("Connection", "close");
      http.onreadystatechange = function() {
        if(http.readyState == 4 && http.status == 200) {
            alert(http.responseText);
        }
      }
      http.send(params);
    }


    function login(){
      return true

      let nome = document.getElementById("nome").value
      let senha = document.getElementById("senha").value

      // let response = request("http://localhost:3000/login", {nome: nome, senha: senha})
      let response = true
      if(response.login){
        window.localStorage.setItem('user', 
        JSON.stringify({
            user: name, 
            password: senha,
            valid: true
        }))
      }
      else{

      }
    }

    function cadastrarProduto(){
      let user = JSON.parse(window.localStorage.getItem('user'))
      
      let produto = {
        nomeProduto: document.getElementById("nomeProduto").value,
        marca: document.getElementById("marca").value,
        preco: document.getElementById("preco").value,
        quantidade: document.getElementById("quantidade").value,
      }
      if(!produto.nomeProduto){
        document.getElementById("error_nomeProduto").textContent="Campo não preenchido"
        document.getElementById("nomeProduto").classList.add("input_error")
      }
      else{
        document.getElementById("nomeProduto").classList.remove("input_error")
        document.getElementById("error_nomeProduto").textContent=""
      }
      if(!produto.marca){
        document.getElementById("error_marca").textContent="Campo não preenchido"
        document.getElementById("marca").classList.add("input_error")
      }
      else{
        document.getElementById("marca").classList.remove("input_error")
        document.getElementById("error_marca").textContent=""
      }
      if(!produto.preco){
        document.getElementById("error_preco").textContent="Campo não preenchido"
        document.getElementById("preco").classList.add("input_error")
      }
      else{
        document.getElementById("preco").classList.remove("input_error")
        document.getElementById("error_preco").textContent=""
      }
      if(!produto.quantidade){
        document.getElementById("error_quantidade").textContent="Campo não preenchido"
        document.getElementById("quantidade").classList.add("input_error")
      }
      else{
        document.getElementById("quantidade").classList.remove("input_error")
        document.getElementById("error_quantidade").textContent=""
      }


      if(produto.nomeProduto && produto.marca && produto.preco && produto.quantidade){
        document.getElementById('id01').style.display='block'
      }

      
      if(user.valid){
        let data = {
            produto: produto,
            user: user
        }
        // let response = request("http://localhost:3000/cadastrar_produto", data)
      }
    }

    function closeModal(){
      document.getElementById('id01').style.display='none'
    }
  </script>  
</body>
</html>